<!DOCTYPE html>
<html ng-app="FacetTreeDemo">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>Jassa UI Angular: Facet Tree Demo</title>
	
    <!-- bower:css -->
	    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css" />
	    <link rel="stylesheet" href="bower_components/jassa-ui-angular/jassa-ui-angular.css" />
	    <!-- endbower -->

    <link rel="stylesheet" href="../../../target/release/repo/jassa-ui-angular.css" />
	
    <script src="bower_components/jscache/cache.js"></script>

    <!-- bower:js -->
    <script src="bower_components/jquery/jquery.js"></script>
    <script src="bower_components/jquery-ui/ui/jquery-ui.js"></script>
    <script src="bower_components/underscore/underscore.js"></script>
    <script src="bower_components/jassa/jassa.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="bower_components/jassa-ui-angular/jassa-ui-angular-tpls.js"></script>
    <!-- endbower -->

    <script src="lib/angular-ui/0.10.0/ui-bootstrap-tpls-0.10.0.js"></script>
    <script src="bower_components/underscore.string/lib/underscore.string.js"></script>

    <script src="bower_components/openlayers/lib/OpenLayers.js"></script>

    <script src="../../../target/release/repo/jassa-ui-angular-geo-openlayers-tpls.js"></script>
	
	<script type="text/javascript">
    _.mixin(_.str.exports());

	var rdf = Jassa.rdf;
	var sparql = Jassa.sparql;
    var service = Jassa.service;
	var sponate = Jassa.sponate;
    var facete = Jassa.facete;
	var geo = Jassa.geo;

    var myModule = angular.module('FacetTreeDemo', ['ui.bootstrap', 'ui.jassa']);

    myModule.controller('MyCtrl', ['$scope', function($scope) {

		var sparqlService = new service.SparqlServiceHttp('http://dbpedia.org/sparql', ['http://dbpedia.org']);
		//var sparqlService = new service.SparqlServiceHttp('http://localhost:8800/sparql', ['http://localhost/geostats.virt.fixed.nt']);
//		var sparqlService = new service.SparqlServiceHttp('http://localhost/fts-sparql', ['http://localhost/geostats.nt']);

		sparqlService = new service.SparqlServiceCache(sparqlService);
		sparqlService = new service.SparqlServicePaginate(sparqlService, 1000);


		$scope.sparqlService = sparqlService;		
        $scope.facetTreeConfig = new facete.FacetTreeConfig();

        
        
        $scope.path = null;

        $scope.selectFacet = function(path) {
            //alert('Selected Path: [' + path + ']');
            $scope.path = path;
        };

        /*
        var cm = $scope.facetTreeConfig.getFacetConfig().getConstraintManager();

        cm.addConstraint(
			new facete.ConstraintSpecPathValue(
			    'equal',
			    facete.Path.parse('http://www.w3.org/1999/02/22-rdf-syntax-ns#type'),
			    rdf.NodeFactory.createUri('http://dbpedia.org/ontologyCastle')
			)
		);
        */
        

        $scope.dataSources = [{
			sparqlService: sparqlService,
			mapLinkFactory: geo.GeoMapFactoryUtils.wgs84MapFactory,
			//mapLinkFactory: geo.GeoMapFactoryUtils.ogc84MapFactory,
			concept: facete.ConceptUtils.createSubjectConcept(rdf.NodeFactory.createVar('s')),
		    quadTreeConfig: {
				maxItemsPerTileCount: 1000,
				maxGlobalItemCount: 10000
			}
		}];
    }]);
	</script>

</head>

<body ng-controller="MyCtrl">

	<div style="position: absolute; top: 0px; left: 0px; width: 470px; max-height: 100%; overflow: auto; margin: 5px;">

		<div class="panel panel-info"> 
			<div class="panel-heading">
				<i class="panel-title">Facet Tree</i>
			</div>
			<div class="panel-body">
			   <facet-tree style="width: 500px; height: 300px;" sparql-service="sparqlService" facet-tree-config="facetTreeConfig" select="selectFacet(path)"></facet-tree>
			</div>
		</div>

		<div class="panel panel-info"> 
			<div class="panel-heading">
				<i class="panel-title">Facet Values</i>
			</div>
			<div class="panel-body">
   				<facet-value-list sparql-service="sparqlService" facet-tree-config="facetTreeConfig" path="path"></facet-value-list>
			</div>
		</div>

		<div class="panel panel-info"> 
			<div class="panel-heading">
				<i class="panel-title">Constraints</i>
			</div>
			<div class="panel-body">
   				<constraint-list sparql-service="sparqlService" facet-tree-config="facetTreeConfig"></constraint-list>
			</div>
		</div>

	</div>

<!--     <div jassa-map-ol="map" style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%; z-index:-9999" config="dataSources"></div> -->

</body>

</html>

